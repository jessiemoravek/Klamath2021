---
title: "2021_Temp_Visualization"
output: html_document
---

Standing questions for Albert:
-Stender Pond SN 20878650 is for some reason reading on offset 15 min intervals (i.e. starting on 16:37?) How should I deal with this? 
-If I can tell a sensor was out of the water, do I remove those datapoints? 
-How do I deal with datasets that are missing several months of data? 


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(patchwork)
library(astsa)
library(forecast)
library(dplyr)
library(pander)
library(MARSS)
library(MASS)
library(gridExtra)
library(weathermetrics)
```

##Variates and responses ("dat")
#### Alexander Pond 
```{r, include=FALSE}
AP1 <- read.csv("Alexander_SN_20870137.csv")
AP1$date <- lubridate::mdy_hm(AP1$Date_Time)
plot(AP1$date, AP1$Temp)
plot(AP1$date, AP1$Intensity)#Note: Something wrong with intensity values starting in April??
head(AP1, n = 50) #Need to remove first 4 values (not in the water yet)
tail(AP1, n = 100) #Need to remove last 8 values. Sensor was dying and repeated a measurement at 11:00, removed at 10:45 to be safe. 
AP1 <- AP1[c(4:30126),] 
str(AP1) #Now we have 30123 observations
head(AP1)
tail(AP1)
missing_data <- AP1[!complete.cases(AP1),] #Missing data at 10:37 on 28 July 2020 when sensor was read. Deleted these in .csv file
missing_data

#Convert to time series
AP1ts <- ts(AP1$Temp, start = c(10, 65), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 10 at 16:15, or the 65th increment
ts.plot(AP1ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day") 

#calculate daily mean, max, min, and amplitude
AP1$day <- lubridate::day(AP1$date)
AP1_daily <- AP1 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```

```{r, include = FALSE}
AP2 <- read.csv("Alexander_SN_20878648.csv")
AP2$date <- lubridate::mdy_hm(AP2$Date_Time)
plot(AP2$date, AP2$Temp)
head(AP2, n = 50) #Need to remove first 6 values (not in the water yet)
tail(AP2, n = 50) #Last NAs already removed in .csv file. Note that sensor failed on 1 October 2020
AP2 <- AP2[c(7:7976),] 
str(AP2) #Now we have 7970  observations
head(AP2)
tail(AP2)
missing_data <- AP2[!complete.cases(AP2),] 
missing_data #No missing data

#Convert to time series
AP2ts <- ts(AP2$Temp, start = c(10, 68), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 10 at 17:00, or the 68th increment
ts.plot(AP2ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day") 

#calculate daily mean, max, min, and amplitude
AP2$day <- lubridate::day(AP2$date)
AP2_daily <- AP2 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```

```{r, include = FALSE}
AP3 <- read.csv("Alexander_SN_20878664.csv")
AP3$date <- lubridate::mdy_hm(AP3$Date_Time)
plot(AP3$date, AP3$Temp)
head(AP3, n = 50) #Need to remove first 5 values (not in the water yet)
tail(AP3, n = 50) #Last NAs already removed in .csv file. 
AP3 <- AP3[c(6:35309),] 
str(AP3) #Now we have 35304  observations
head(AP3)
tail(AP3)
missing_data <- AP3[!complete.cases(AP3),] 
missing_data#No missing data

#Convert to time series
AP3ts <- ts(AP3$Temp, start = c(10, 67), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 10 at 16:45, or the 67th increment
ts.plot(AP3ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
AP3$day <- lubridate::day(AP3$date)
AP3_daily <- AP3 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```

```{r, include = FALSE}
APck <- read.csv("AlexanderCk_SN_20878703.csv")
APck$date <- lubridate::mdy_hm(APck$Date_Time)
plot(APck$date, APck$Temp)
head(APck, n = 100) #Need to remove first 87 values (not in the water yet)
tail(APck, n = 500) #Last NAs already removed in .csv file. Sensor seems like it might be out of the water somewhere in late Jan 2021
APck <- APck[c(88:35309),] 
str(APck) #Now we have 35222  observations
head(APck)
tail(APck)
missing_data <- APck[!complete.cases(APck),] 
missing_data #No missing data

#Convert to time series
APckts <- ts(APck$Temp, start = c(11, 53), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 11 at 13:15, or the 53th increment
ts.plot(APckts,main="Temperature",ylab = "Temperature (C)", xlab = "Day") 

#calculate daily mean, max, min, and amplitude
APck$day <- lubridate::day(APck$date)
APck_daily <- APck %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


#####Stender Pond
```{r, include = FALSE}
SP1 <- read.csv("Stender_SN_20870127.csv")
SP1$date <- lubridate::mdy_hm(SP1$Date_Time)
plot(SP1$date, SP1$Temp)
head(SP1, n = 100) #Need to remove first 11 values (not in the water yet) 
tail(SP1) #Last NAs already removed in .csv file.
SP1 <- SP1[c(12:35241),] 
str(SP1) #Now we have 35230  observations
head(SP1)
tail(SP1)
missing_data <- SP1[!complete.cases(SP1),] 
missing_data #No missing data

#Convert to time series
SP1ts <- ts(SP1$Temp, start = c(11, 66), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 11 at 16:30, or the 66th increment
ts.plot(SP1ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
SP1$day <- lubridate::day(SP1$date)
SP1_daily <- SP1 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r, include = FALSE}
SPout <- read.csv("StenderOut_SN_20878705.csv")
SPout$date <- lubridate::mdy_hm(SPout$Date_Time)
plot(SPout$date, SPout$Temp)
head(SPout, n = 100) #Need to remove first 10 values (never in the water, in a dry outflow channel)
tail(SPout) #Last NAs already removed in .csv file.
SPout <- SPout[c(11:35240),] 
str(SPout) #Now we have 35230  observations
head(SPout)
tail(SPout)
missing_data <- SPout[!complete.cases(SPout),] 
missing_data #No missing data

#Convert to time series
SPoutts <- ts(SPout$Temp, start = c(11, 65), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 11 at 16:15, or the 65th increment
ts.plot(SPoutts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
SPout$day <- lubridate::day(SPout$date)
SPout_daily <- SPout %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r, include = FALSE}
#SN 650 (11 - 28 July 2020)
SP2a <- read.csv("StenderRm_SN_20878650.csv")
SP2a$date <- lubridate::mdy_hm(SP2a$Date_Time)
plot(SP2a$date, SP2a$Temp)
head(SP2a, n = 100) #Need to remove first 8 values
tail(SP2a, n = 800) #Need to remove NAs in the last several days and get up to 12:30 when next sensor was placed. Lots of weird NAs to remove
SP2a <- SP2a[c(9:1625,1661:1662),] 
str(SP2a) #Now we have 1619 observations
head(SP2a)
tail(SP2a)
missing_data <- SP2a[!complete.cases(SP2a),]
missing_data #No missing data
```


```{r, include = FALSE}
#SN 711 (28 July 2020 - 13 July 2021)
SP2b <- read.csv("Stender_SN_20878711.csv")
SP2b$date <- lubridate::mdy_hm(SP2b$Date_Time)
plot(SP2b$date, SP2b$Temp)
head(SP2b, n = 100) #Need to remove first value to match with SN 650
tail(SP2b, n = 800) #Last NAs already removed in .csv file.
SP2b <- SP2b[c(2:33614),] 
str(SP2b) #Now we have 33613 observations
head(SP2b)
tail(SP2b)
missing_data <- SP2b[!complete.cases(SP2b),] 
missing_data #No missing data
```


```{r, include = FALSE}
##Combine SN 650 and SN 711 (711 replaced 650 on 28 July 2020 at ~12:15)
#SP2 is 11 July 2020 - 13 July 2021

SP2 <- rbind(SP2a,SP2b)
str(SP2) #Now we have 35232  observations
head(SP2)
tail(SP2)
missing_data <- SP2[!complete.cases(SP2),] 
missing_data #No missing data

#Convert to time series
SP2ts <- ts(SP2$Temp, start = c(11, 63), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on JSP2y 11 at 15:45, or the 63th increment
ts.plot(SP2ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day") 

#calculate daily mean, max, min, and amplitude
SP2$day <- lubridate::day(SP2$date)
SP2_daily <- SP2 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r, include = FALSE}
SPck <- read.csv("StenderCk_SN_20870136.csv")
SPck$date <- lubridate::mdy_hm(SPck$Date_Time)
plot(SPck$date, SPck$Temp)
head(SPck, n = 100) #Need to remove first 5 values. Also remove 1140:1141 on 28 July 2020 when sensor was reset 
tail(SPck, n = 800) #Sensor started to fail on 15 April 2021, removed last day of readings. Note that sensor failed on 16 April 2021
SPck <- SPck[c(6:1139,1142:26240),] 
str(SPck) #Now we have 26233 observations
head(SPck)
tail(SPck)
missing_data <- SPck[!complete.cases(SPck),] #No missing data
missing_data

#Convert to time series
SPckts <- ts(SPck$Temp, start = c(16, 75), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 16 at 18:45, or the 75th increment
ts.plot(SPckts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
SPck$day <- lubridate::day(SPck$date)
SPck_daily <- SPck %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```

#####Durazo Pond
```{r, include = FALSE}
Durazo <- read.csv("Durazo_SN_20878643.csv")
Durazo$date <- lubridate::mdy_hm(Durazo$Date_Time)
plot(Durazo$date, Durazo$Temp)
head(Durazo, n = 100) #Need to remove first 9 values 
tail(Durazo) #NAs removed in excel
Durazo <- Durazo[c(10:35019),] 
str(Durazo) #Now we have 35010  observations
head(Durazo)
tail(Durazo)
missing_data <- Durazo[!complete.cases(Durazo),] 
missing_data #No missing data

#Convert to time series
Durazots <- ts(Durazo$Temp, start = c(13, 69), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 13 at 17:15, or the 69th increment
ts.plot(Durazots,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
Durazo$day <- lubridate::day(Durazo$date)
Durazo_daily <- Durazo %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))

```


#####Lower Seiad Pond
```{r, include = FALSE}
LS <- read.csv("LowerSeiad_SN_20878706.csv")
LS$date <- lubridate::mdy_hm(LS$Date_Time)
plot(LS$date, LS$Temp)
head(LS, n = 100) #Need to remove first 3 values 
tail(LS) #Last several NAs removed in excel 
LS <- LS[c(4:35021),] 
str(LS) #Now we have 35018 observations
head(LS)
tail(LS)
missing_data <- LS[!complete.cases(LS),] 
missing_data #No missing data

#Convert to time series
LSts <- ts(LS$Temp, start = c(13, 52), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 13 at 13:00, or the 52th increment
ts.plot(LSts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
LS$day <- lubridate::day(LS$date)
LS_daily <- LS %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))

```

```{r, include = FALSE}
LSck <- read.csv("LowerSeiadCk_SN_20878668.csv")
LSck$date <- lubridate::mdy_hm(LSck$Date_Time)
plot(LSck$date, LSck$Temp)
head(LSck, n = 100) #Need to remove first 4 values 
tail(LSck) #Need to remove last value
LSck <- LSck[c(5:35020),] 
str(LSck) #Now we have 35016  observations
head(LSck)
tail(LSck)
missing_data <- LSck[!complete.cases(LSck),] #No missing data
missing_data #No missing data

#Convert to time series
LSckts <- ts(LSck$Temp, start = c(13, 56), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 13 at 14:00, or the 56th increment
ts.plot(LSckts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020")

#calculate daily mean, max, min, and amplitude
LSck$day <- lubridate::day(LSck$date)
LSck_daily <- LSck %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))

```

#####May Pond
```{r, include = FALSE}
May <- read.csv("May_SN_20870134.csv")
May$date <- lubridate::mdy_hm(May$Date_Time)
plot(May$date, May$Temp)
head(May, n = 100) #Need to remove first 3 values 
tail(May, n = 400) #NAs removed in .csv file -- Note, sensor died in June and removed last several days of data 
May <- May[c(4:1438,1443:32628),] 
str(May) #Now we have 32621 observations
head(May)
tail(May)
missing_data <- May[!complete.cases(May),] #No missing data
missing_data #No missing data

#Convert to time series
Mayts <- ts(May$Temp, start = c(13, 46), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 13 at 11:30, or the 46th increment
ts.plot(Mayts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
May$day <- lubridate::day(May$date)
May_daily <- May %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))

```

```{r, include = FALSE}
MayCk <- read.csv("MayCk_SN_20878646.csv")
MayCk$date <- lubridate::mdy_hm(MayCk$Date_Time)
plot(MayCk$date, MayCk$Temp)
head(MayCk, n = 100) #Need to remove first 3 values 
tail(MayCk) #All good
MayCk <- MayCk[c(4:35028),] 
str(MayCk) #Now we have 35025  observations
head(MayCk)
tail(MayCk)
missing_data <- MayCk[!complete.cases(MayCk),]
missing_data #No missing data

#Convert to time series
MayCkts <- ts(MayCk$Temp, start = c(13, 47), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 13 at 11:45, or the 47th increment
ts.plot(MayCkts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
MayCk$day <- lubridate::day(MayCk$date)
MayCk_daily <- MayCk %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))

```

####Fish Gulch
```{r, include = F}
FG2 <- read.csv("FishGulch_SN_20870133.csv")
FG2$date <- lubridate::mdy_hm(FG2$Date_Time) 
plot(FG2$date, FG2$Temp)
head(FG2, n = 50) #Need to remove first 10 values (not in the water yet)
tail(FG2, n = 50) #Look sok 
FG2 <- FG2[c(11:1653,1657:35244),] 
str(FG2) #Now we have 35231 observations
head(FG2)
tail(FG2)
missing_data <- FG2[!complete.cases(FG2),]
missing_data #No missing data

#Convert to time series
FG2ts <- ts(FG2$Temp, start = c(10, 52), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 10 at 13:00, or the 52nd increment
ts.plot(FG2ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
FG2$day <- lubridate::day(FG2$date)
FG2_daily <- FG2 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r,include = F}
FG3 <- read.csv("FishGulch_SN_20878708.csv")
FG3$date <- lubridate::mdy_hm(FG3$Date_Time) 
plot(FG3$date, FG3$Temp)
head(FG3, n = 50) #Need to remove first 8 values (not in the water yet)
tail(FG3, n = 50) #Looks ok. 
FG3 <- FG3[c(9:1652,1666:35242),] 
str(FG3) #Now we have 35234  observations
head(FG3)
tail(FG3)
missing_data <- FG3[!complete.cases(FG3),]
missing_data #No missing data

#Convert to time series
FG3ts <- ts(FG3$Temp, start = c(10, 50), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 10 at 12:30, or the 50th increment
ts.plot(FG3ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
FG3$day <- lubridate::day(FG3$date)
FG3_daily <- FG3 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r, include = F}
FGck <- read.csv("FishGulchCk_SN_20878671.csv")
FGck$date <- lubridate::mdy_hm(FGck$Date_Time) 
plot(FGck$date, FGck$Temp)
head(FGck, n = 50) #looks ok
tail(FGck, n = 50) #looks ok
FGck <- FGck[c(1:1640,1643:35233),] 
str(FGck) #Now we have 35231 observations
head(FGck)
tail(FGck)
missing_data <- FGck[!complete.cases(FGck),] 
missing_data #No missing data

#Convert to time series
FGckts <- ts(FGck$Temp, start = c(10, 56), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 10 at 14:00, or the 56th increment
ts.plot(FGckts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
FGck$day <- lubridate::day(FGck$date)
FGck_daily <- FGck %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


#####Goodman Pond
```{r, include = F}
GP1 <- read.csv("Goodman_SN_20878644.csv")
GP1$date <- lubridate::mdy_hm(GP1$Date_Time)
plot(GP1$date, GP1$Temp)
head(GP1, n = 50) #Need to remove first 1 values (not in the water yet)
tail(GP1, n = 50) #Need to remove last 8 values (out of water) 
GP1 <- GP1[c(2:1749,1753:35336),] 
str(GP1) #Now we have 35335  observations
head(GP1)
tail(GP1)
missing_data <- GP1[!complete.cases(GP1),] #No missing data
missing_data #No missing data

#Convert to time series
GP1ts <- ts(GP1$Temp, start = c(9, 47), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 9 at 11:45, or the 47th increment
ts.plot(GP1ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
GP1$day <- lubridate::day(GP1$date)
GP1_daily <- GP1 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r, include = F}
GP2 <- read.csv("Goodman_SN_20878647.csv")
GP2$date <- lubridate::mdy_hm(GP2$Date_Time)
plot(GP2$date, GP2$Temp)
head(GP2, n = 50) #Need to remove first 2 values (not in the water yet)
tail(GP2, n = 50) #looks ok 
GP2 <- GP2[c(3:1749,1752:35343),] 
str(GP2) #Now we have 35341  observations
head(GP2)
tail(GP2)
missing_data <- GP2[!complete.cases(GP2),]
missing_data #No missing data

#Convert to time series
GP2ts <- ts(GP2$Temp, start = c(9, 49), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 9 at 12:15, or the 49th increment
ts.plot(GP2ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
GP2$day <- lubridate::day(GP2$date)
GP2_daily <- GP2 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


```{r, include = F}
GP3 <- read.csv("Goodman_SN_20878659.csv")
GP3$date <- lubridate::mdy_hm(GP3$Date_Time)
plot(GP3$date, GP3$Temp)
head(GP3, n = 50) #Need to remove first 2 values (not in the water yet)
tail(GP3, n = 50) #looks ok 
GP3 <- GP3[c(3:1748,1751:35343),] 
str(GP3) #Now we have 1746 observations
head(GP3)
tail(GP3)
missing_data <- GP3[!complete.cases(GP3),]
missing_data #No missing data

#Convert to time series
GP3ts <- ts(GP3$Temp, start = c(9, 49), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 9 at 12:15, or the 49th increment
ts.plot(GP3ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
GP3$day <- lubridate::day(GP3$date)
GP3_daily <- GP3 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```

```{r, include = F}
GPck <- read.csv("GoodmanCk_SN_20878654.csv")
GPck$date <- lubridate::mdy_hm(GPck$Date_Time)
plot(GPck$date, GPck$Temp)
head(GPck, n = 50) #Need to remove first 1 values (not in the water yet)
tail(GPck, n = 50) #Need to remove last 1 value 
GPck <- GPck[c(2:1071,1074:34666),] 
str(GPck) #Now we have 34663  observations
missing_data <- GPck[!complete.cases(GPck),]#No missing data
missing_data

#Convert to time series
GPckts <- ts(GPck$Temp, start = c(16, 54), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 16 at 13:30, or the 54th increment
ts.plot(GPckts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
GPck$day <- lubridate::day(GPck$date)
GPck_daily <- GPck %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```


#####Upper Lawrence Pond
```{r, include = F}
ULout <- read.csv("UpperLawrence3_SN_20878673.csv")
ULout$date <- lubridate::mdy_hm(ULout$Date_Time)
plot(ULout$date, ULout$Temp)
head(ULout, n = 50) #Need to remove first 22 values (not in the water yet)
tail(ULout, n = 50) #looks ok 
ULout <- ULout[c(23:1943,1946:35520),] 
str(ULout) #Now we have 1922 observations
missing_data <- ULout[!complete.cases(ULout),]
missing_data #No missing data

#Convert to time series
ULoutts <- ts(ULout$Temp, start = c(7, 56), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 7 at 16:00, or the 56th increment
ts.plot(ULoutts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
ULout$day <- lubridate::day(ULout$date)
ULout_daily <- ULout %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```

```{r, include = F}
UL1 <- read.csv("UpperLawrence1_SN_20878682.csv")
UL1$date <- lubridate::mdy_hm(UL1$Date_Time)
plot(UL1$date, UL1$Temp)
head(UL1, n = 50) #Need to remove first 5 values (not in the water yet)
tail(UL1, n = 1150) #Need to remove last several days; sensor removed on 12 July 2021
UL1 <- UL1[c(6:35531),] 
str(UL1) #Now we have 35526  observations
missing_data <- UL1[!complete.cases(UL1),] #No missing data
missing_data

#Convert to time series
UL1ts <- ts(UL1$Temp, start = c(7, 46), frequency = 96) #The sensor records 96 readings per day (15 minute increments). This time series starts on July 7 at 11:30, or the 46th increment
ts.plot(UL1ts,main="Temperature",ylab = "Temperature (C)", xlab = "Day of July 2020") 

#calculate daily mean, max, min, and amplitude
UL1$day <- lubridate::day(UL1$date)
UL1_daily <- UL1 %>% 
  group_by(day) %>% 
  summarize(mean_temp=mean(Temp),max_temp=max(Temp), min_temp=min(Temp), amp_temp=(max(Temp)-min(Temp)))
```
